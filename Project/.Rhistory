xtest[ytest == 1, ] <- xtest[ytest == 1, ] + 1
testdat <- data.frame(x = xtest, y = as.factor(ytest))
tail(testdat)
ypred <- predict(bestmod, testdat)
table(predict = ypred, truth = testdat$y)
set.seed(6891)
x <- matrix(rnorm(200*2), ncol = 2)
x[1:100,] <- x[1:100,] + 2
x[101:150,] <- x[101:150,] - 2
y <- c(rep(1, 150), rep(2, 50))
dat <- data.frame(x = x, y = as.factor(y))
head(dat)
plot(x, col = y, pch = 16)
train <- sample(200, 100)
tail(as.data.frame(train))
svmfit <- svm(y~., data = dat[train, ],
kernel = "radial", gamma = 1, cost = 1)
plot(svmfit, dat[train, ])
summary(svmfit)
svmfit <- svm(y~., data = dat[train, ],
kernel = "radial", gamma = 1, cost = 1e5)
plot(svmfit, dat[train, ])
set.seed(1980)
tune.out <- tune(svm, y~., data = dat[train, ], kernel = "radial",
ranges = list(cost = c(0.1, 1, 10, 100, 1000),
gamma = c(0.5, 1, 2, 3, 4)))
summary(tune.out)
table(true = dat[-train, "y"],
pred = predict(tune.out$best.model, newdata = dat[-train,]))
library(TSA)
data(oilfilters); plot(oilfilters, type = "o", ylab = "Ventas", xlab = "Tiempo", main = "Ventas Mesuales ")
plot(oilfilters, type = "l", ylab = "Ventas", xlab = "Tiempo",
main = "Ventas Mensuales de Filtro de Aceite",
sub = "Símbolos Especiales")
points(y = oilfilters, x = time(oilfilters),
pch = as.vector(season(oilfilters)))
data(AirPassengers)
AP <- AirPassengers
AP
class(AP)
start(AP); end(AP); frequency(AP)
CBE <- read.csv("cbe.csv", header = TRUE)
setwd("~/Programacion-con-R-Santander-master/Sesion-05/Ejemplo-01")
CBE <- read.csv("cbe.csv", header = TRUE)
setwd("~/Programacion-con-R-Santander-master/Sesion-06/Ejemplo-01")
CBE <- read.csv("cbe.csv", header = TRUE)
setwd("C:/Users/dapar/Downloads/Programacion-con-R-Santander-master (4)/Programacion-con-R-Santander-master/Sesion-06/Ejemplo-01")
CBE <- read.csv("cbe.csv", header = TRUE)
CBE[1:4,]
class(CBE)
Elec.ts <- ts(CBE[, 3], start = 1958, freq = 12)
Beer.ts <- ts(CBE[, 2], start = 1958, freq = 12)
Choc.ts <- ts(CBE[, 1], start = 1958, freq = 12)
Electricidad <- Elec.ts
Cerveza <- Beer.ts
Chocolate <- Choc.ts
plot(cbind(Electricidad, Cerveza, Chocolate),
main = "Producción de Chocolate, Cerveza y Electricidad",
xlab = "Tiempo",
sub = "Enero de 1958 - Diciembre de 1990")
CBE <- read.csv("cbe.csv", header = TRUE)
CBE[1:4,]
class(CBE)
indices.2005.general.ts <- ts(indices.2005$General, start = 2005, freq = 12)
plot(indices.2005.general.ts,
main = "Producción de Chocolate, Cerveza y Electricidad",
xlab = "Tiempo",
sub = "Enero de 1958 - Diciembre de 1990")
indices.2005.general.ts <- ts(indices.2005$General, start = 2005, freq = 12)
plot(indices.2005.general.ts,
main = "Inflacion en Mexico",
xlab = "Tiempo",
ylab = "Inflacion",
sub = "Enero de 2005 - Diciembre de 2020")
indices.2005.general.ts.aditivo <- decompose(indices.2005.general.ts)
plot(indices.2005.general.ts.aditivo, xlab = "Tiempo",
sub = "Descomposición de los datos de inflacion")
indices.2005.general.ts.aditivo <- decompose(indices.2005.general.ts)
plot(indices.2005.general.ts.aditivo, xlab = "Tiempo",
sub = "Descomposición de los datos de inflacion")
Tendencia <- indices.2005.general.ts.aditivo$trend
Estacionalidad <- indices.2005.general.ts.aditivo$seasonal
Aleatorio <- indices.2005.general.ts.aditivo$random
ts.plot(cbind(Tendencia, Tendencia + Estacionalidad),
xlab = "Tiempo", main = "Datos de Producción de Electricidad",
ylab = "Producción de electricidad", lty = 1:2,
sub = "Tendencia con efectos estacionales aditivos sobrepuestos")
Tendencia[20] + Estacionalidad[20] + Aleatorio[20]
Elec.ts[20]
indices.2005.general.ts.multiplicativo <- decompose(indices.2005.general.ts)
plot(indices.2005.general.ts.multiplicativo, xlab = "Tiempo",
sub = "Descomposición de los datos de producción de electricidad")
indices.2005.general.ts.multiplicativo <- decompose(indices.2005.general.ts)
plot(indices.2005.general.ts.multiplicativo, xlab = "Tiempo",
sub = "Descomposición de los datos de producción de electricidad")
Trend <- indices.2005.general.ts.multiplicativo$trend
Seasonal <- indices.2005.general.ts.multiplicativo$seasonal
Random <- indices.2005.general.ts.multiplicativo$random
ts.plot(cbind(Trend, Trend*Seasonal), xlab = "Tiempo", main = "Datos de Producción de Electricidad",
ylab = "Producción de electricidad", lty = 1:2,
sub = "Tendencia con efectos estacionales multiplicativos sobrepuestos")
CBE <- read.csv("cbe.csv", header = TRUE)
Elec.ts <- ts(CBE[, 3], start = 1958, freq = 12)
Elec.decom.A <- decompose(Elec.ts)
plot(Elec.decom.A, xlab = "Tiempo",
sub = "Descomposición de los datos de producción de electricidad")
Tendencia <- Elec.decom.A$trend
Estacionalidad <- Elec.decom.A$seasonal
Aleatorio <- Elec.decom.A$random
ts.plot(cbind(Tendencia, Tendencia + Estacionalidad),
xlab = "Tiempo", main = "Datos de Producción de Electricidad",
ylab = "Producción de electricidad", lty = 1:2,
sub = "Tendencia con efectos estacionales aditivos sobrepuestos")
Tendencia[20] + Estacionalidad[20] + Aleatorio[20]
Elec.ts[20]
Elec.decom.M <- decompose(Elec.ts, type = "mult")
plot(Elec.decom.M, xlab = "Tiempo",
sub = "Descomposición de los datos de producción de electricidad")
Trend <- Elec.decom.M$trend
Seasonal <- Elec.decom.M$seasonal
Random <- Elec.decom.M$random
ts.plot(cbind(Trend, Trend*Seasonal), xlab = "Tiempo", main = "Datos de Producción de Electricidad",
ylab = "Producción de electricidad", lty = 1:2,
sub = "Tendencia con efectos estacionales multiplicativos sobrepuestos")
Trend <- indices.2005.general.ts.multiplicativo$trend
Seasonal <- indices.2005.general.ts.multiplicativo$seasonal
Random <- indices.2005.general.ts.multiplicativo$random
ts.plot(cbind(Trend, Trend*Seasonal), xlab = "Tiempo", main = "Datos de Producción de Electricidad",
ylab = "Producción de electricidad", lty = 1:2,
sub = "Tendencia con efectos estacionales multiplicativos sobrepuestos")
indices.2005.general.ts.multiplicativo <- decompose(indices.2005.general.ts, type = "mult")
plot(indices.2005.general.ts.multiplicativo, xlab = "Tiempo",
sub = "Descomposición de los datos de producción de electricidad")
Trend <- indices.2005.general.ts.multiplicativo$trend
Seasonal <- indices.2005.general.ts.multiplicativo$seasonal
Random <- indices.2005.general.ts.multiplicativo$random
ts.plot(cbind(Trend, Trend*Seasonal), xlab = "Tiempo", main = "Datos de Producción de Electricidad",
ylab = "Producción de electricidad", lty = 1:2,
sub = "Tendencia con efectos estacionales multiplicativos sobrepuestos")
indices.2005.general.ts.multiplicativo <- decompose(indices.2005.general.ts, type = "mult")
plot(indices.2005.general.ts.multiplicativo, xlab = "Tiempo",
sub = "Descomposición de los datos de producción de electricidad")
Trend <- indices.2005.general.ts.multiplicativo$trend
Seasonal <- indices.2005.general.ts.multiplicativo$seasonal
Random <- indices.2005.general.ts.multiplicativo$random
ts.plot(cbind(Trend, Trend*Seasonal), xlab = "Tiempo", main = "Datos de Producción de Electricidad",
ylab = "Producción de electricidad", lty = 1:2,
sub = "Tendencia con efectos estacionales multiplicativos sobrepuestos")
set.seed(1)
w <- rnorm(100)
plot(w, type = "l", xlab = "")
title(main = "Ruido Blanco Gaussiano", xlab = "Tiempo")
x <- seq(-3, 3, length = 1000)
hist(rnorm(100), prob = T, ylab = "", xlab = "", main = "")
points(x, dnorm(x), type = "l")
title(ylab = "Densidad", xlab = "Valores simulados de la distribución normal estandar",
main = "Comparación de una muestra con su población subyacente")
set.seed(2)
acf(rnorm(100), main = "")
title(main = "Función de Autocorrelación Muestral",
sub = "Valores simulados de la distribución normal estandar")
x <- w <- rnorm(1000)
for(t in 2:1000) x[t] <- x[t-1] + w[t]
plot(x, type = "l", main = "Caminata Aleatoria Simulada",
xlab = "t", ylab = expression(x[t]),
sub = expression(x[t]==x[t-1]+w[t]))
acf(x, main = "")
title(main = "Correlograma para la caminata aleatoria simulada",
sub = expression(x[t]==x[t-1]+w[t]))
acf(diff(x), main = "")
title(main = "Correlograma de la serie de diferencias",
sub = expression(nabla*x[t]==x[t]-x[t-1]))
rho <- function(k, alpha) alpha^k
plot(0:10, rho(0:10, 0.7), type = "h", ylab = "", xlab = "")
title(main = "Correlograma para un proceso AR(1)",
ylab = expression(rho[k] == alpha^k),
xlab = "lag k",
sub = expression(x[t]==0.7*x[t-1]+w[t]))
plot(0:10, rho(0:10, -0.7), type = "h", ylab = "", xlab = "")
title(main = "Correlograma para un proceso AR(1)",
ylab = expression(rho[k] == alpha^k),
xlab = "lag k",
sub = expression(x[t]==-0.7*x[t-1]+w[t]))
abline(h = 0)
set.seed(1)
x <- w <- rnorm(100)
for(t in 2:100) x[t] <- 0.7 * x[t-1] + w[t]
plot(x, type = "l", xlab = "", ylab = "")
title(main = "Proceso AR(1) simulado",
xlab = "Tiempo",
ylab = expression(x[t]),
sub = expression(x[t]==0.7*x[t-1]+w[t]))
acf(x, main = "")
title(main = "Correlograma del proceso AR(1) simulado",
sub = expression(x[t]==0.7*x[t-1]+w[t]))
pacf(x, main = "")
title(main = "Correlograma Parcial del proceso AR(1) simulado",
sub = expression(x[t]==0.7*x[t-1]+w[t]))
x.ar <- ar(x, method = "mle")
x.ar$order
x.ar$ar
x.ar$ar + c(-2, 2)*sqrt(x.ar$asy.var)
Global <- scan("global.txt")
Global.ts <- ts(Global, st = c(1856, 1), end = c(2005, 12), fr = 12)
Global.annual <- aggregate(Global.ts, FUN = mean)
plot(Global.ts, xlab = "Tiempo", ylab = "Temperatura en Â°C",
main = "Serie de Temperatura Global",
sub = "Serie mensual: Enero de 1856 a Diciembre de 2005")
plot(Global.annual, xlab = "Tiempo", ylab = "Temperatura en Â°C",
main = "Serie de Temperatura Global",
sub = "Serie anual de temperaturas medias: 1856 a 2005")
mean(Global.annual)
Global.ar <- ar(Global.annual, method = "mle")
Global.ar$order
Global.ar$ar
acf(Global.ar$res[-(1:Global.ar$order)], lag = 50, main = "")
title(main = "Correlograma de la serie de residuales",
sub = "Modelo AR(4) ajustado a la serie de temperaturas globales anuales")
rho <- function(k, beta){
q <- length(beta) - 1
if(k > q) ACF <- 0 else {
s1 <- 0; s2 <- 0
for(i in 1:(q-k+1)) s1 <- s1 + beta[i]*beta[i + k]
for(i in 1:(q+1)) s2 <- s2 + beta[i]^2
ACF <- s1/s2}
ACF}
beta <- c(1, 0.7, 0.5, 0.2)
rho.k <- rep(1, 10)
for(k in 1:10) rho.k[k] <- rho(k, beta)
plot(0:10, c(1, rho.k), ylab = expression(rho[k]), xlab = "lag k", type = "h",
sub = expression(x[t] == w[t] + 0.7*w[t-1] + 0.5*w[t-2] + 0.2*w[t-3]),
main = "Función de autocorrelación para un proceso MA(3)")
abline(0, 0)
beta <- c(1, -0.7, 0.5, -0.2)
rho.k <- rep(1, 10)
for(k in 1:10) rho.k[k] <- rho(k, beta)
plot(0:10, c(1, rho.k), ylab = expression(rho[k]), xlab = "lag k", type = "h",
sub = expression(x[t] == w[t] - 0.7*w[t-1] + 0.5*w[t-2] - 0.2*w[t-3]),
main = "Función de autocorrelación para un proceso MA(3)")
abline(0, 0)
set.seed(1)
b <- c(0.8, 0.6, 0.4)
x <- w <- rnorm(1000)
for(t in 4:1000){
for(j in 1:3) x[t] <- x[t] + b[j]*w[t-j]
}
plot(x, type = "l", ylab = expression(x[t]), xlab = "Tiempo t",
sub = expression(x[t] == w[t] + 0.8*w[t-1] + 0.6*w[t-2] + 0.4*w[t-3]),
main = "Serie de tiempo simulada de un proceso MA(3)")
acf(x, main = "")
title(main = "Correlograma para un proceso MA(3) simulado",
sub = expression(x[t] == w[t] + 0.8*w[t-1] + 0.6*w[t-2] + 0.4*w[t-3]))
x.ma <- arima(x, order = c(0, 0, 3))
x.ma
set.seed(1)
x <- arima.sim(n = 10000, list(ar = -0.6, ma = 0.5))
plot(x[1:100], type = "l", xlab = "")
title(main = "Serie simulada", xlab = "Tiempo",
sub = expression(x[t] == -0.6*x[t-1] + w[t] + 0.5*w[t-1]))
coef(arima(x, order = c(1, 0, 1)))
CBE <- read.csv("cbe.csv", header = TRUE)
Elec.ts <- ts(CBE[, 3], start = 1958, freq = 12)
plot(Elec.ts, xlab = "", ylab = "")
title(main = "Serie de Producción de Electricidad",
xlab = "Tiempo",
ylab = "Producción de electricidad")
plot(log(Elec.ts), xlab = "", ylab = "")
title(main = "Serie-log de Producción de Electricidad",
xlab = "Tiempo",
ylab = "Log de Producción de electricidad")
Time <- 1:length(Elec.ts)
Imth <- cycle(Elec.ts)
Elec.lm <- lm(log(Elec.ts) ~ Time + I(Time^2) + factor(Imth))
acf(resid(Elec.lm), main = "")
title(main = "Correlograma de la serie de residuales del modelo de regresión",
sub = "Serie de producción de electricidad")
plot(resid(Elec.lm), type = "l", main = "", xlab = "", ylab = "")
title(main = "Serie de residuales del modelo de regresión ajustado",
sub = "Serie de producción de electricidad",
xlab = "Tiempo",
ylab = "Residuales")
best.order <- c(0, 0, 0)
best.aic <- Inf
for(i in 0:2)for(j in 0:2){
model <- arima(resid(Elec.lm), order = c(i, 0, j))
fit.aic <- AIC(model)
if(fit.aic < best.aic){
best.order <- c(i, 0, j)
best.arma <- arima(resid(Elec.lm), order = best.order)
best.aic <- fit.aic
}
}
best.order
acf(resid(best.arma), main = "")
title(main = "Serie de residuales del modelo ARMA(2, 0) ajustado",
sub = "Serie de residuales del modelo de regresión ajustado a los datos de electricidad")
new.time <- seq(length(Elec.ts)+1, length = 36)
new.data <- data.frame(Time = new.time, Imth = rep(1:12, 3))
predict.lm <- predict(Elec.lm, new.data)
predict.arma <- predict(best.arma, n.ahead = 36)
elec.pred <- ts(exp(predict.lm + predict.arma$pred), start = 1991, freq = 12)
ts.plot(cbind(Elec.ts, elec.pred), lty = 1:2,
col = c("blue", "red"), xlab = "Tiempo",
ylab = "Producción de electricidad",
main = "Predicción de los datos de producción de electricidad",
sub = "Predicción de 36 meses")
data <- read.csv("Indice-nacional-de-precios-al-consumidor.csv", fileEncoding="UTF-8-BOM")
data <- mutate(data, Periodo = as.Date(Periodo, "%Y-%m-%d"))
data <- mutate(data, General = as.numeric(as.character(General)))
data <- mutate(data, Subyacente = as.numeric(as.character(Subyacente)))
data <- mutate(data, Mercancias = as.numeric(as.character(Mercancias)))
data <- mutate(data, Servicios = as.numeric(as.character(Servicios)))
data <- mutate(data, Nosubyacente = as.numeric(as.character(Nosubyacente)))
data <- mutate(data, Agropecuarios = as.numeric(as.character(Agropecuarios)))
data <- mutate(data, Energeticos = as.numeric(as.character(Energeticos)))
str(data)
head(data)
tail(data)
indices.2005 <-  data %>% filter(Periodo >= ymd("2005-1-1"))
str(indices.2005)
head(indices.2005)
tail(indices.2005)
indices.2005.maxgeneral <- which.max(indices.2005$General)
paste("En la fecha", indices.2005$Periodo[indices.2005.maxgeneral]," se presento la mayor inflacion registrada de 2005 a 2020 con" , indices.2005$General[indices.2005.maxgeneral], "%")
data <- read.csv("Indice-nacional-de-precios-al-consumidor.csv", fileEncoding="UTF-8-BOM")
data <- mutate(data, Periodo = as.Date(Periodo, "%Y-%m-%d"))
setwd("~/Programacion-con-R-Santander-master/Modulo-2-BEDU-Equipo-15/Project")
data <- read.csv("Indice-nacional-de-precios-al-consumidor.csv", fileEncoding="UTF-8-BOM")
data <- mutate(data, Periodo = as.Date(Periodo, "%Y-%m-%d"))
data <- mutate(data, General = as.numeric(as.character(General)))
data <- mutate(data, Subyacente = as.numeric(as.character(Subyacente)))
data <- mutate(data, Mercancias = as.numeric(as.character(Mercancias)))
data <- mutate(data, Servicios = as.numeric(as.character(Servicios)))
data <- mutate(data, Nosubyacente = as.numeric(as.character(Nosubyacente)))
data <- mutate(data, Agropecuarios = as.numeric(as.character(Agropecuarios)))
data <- mutate(data, Energeticos = as.numeric(as.character(Energeticos)))
str(data)
head(data)
tail(data)
indices.2005 <-  data %>% filter(Periodo >= ymd("2005-1-1"))
str(indices.2005)
head(indices.2005)
tail(indices.2005)
indices.2005.maxgeneral <- which.max(indices.2005$General)
paste("En la fecha", indices.2005$Periodo[indices.2005.maxgeneral]," se presento la mayor inflacion registrada de 2005 a 2020 con" , indices.2005$General[indices.2005.maxgeneral], "%")
data <- read.csv("Indice-nacional-de-precios-al-consumidor.csv", fileEncoding="UTF-8-BOM")
data <- mutate(data, Periodo = as.Date(Periodo, "%Y-%m-%d"))
data <- mutate(data, General = as.numeric(as.character(General)))
data <- mutate(data, Subyacente = as.numeric(as.character(Subyacente)))
data <- mutate(data, Mercancias = as.numeric(as.character(Mercancias)))
data <- mutate(data, Servicios = as.numeric(as.character(Servicios)))
data <- mutate(data, Nosubyacente = as.numeric(as.character(Nosubyacente)))
data <- mutate(data, Agropecuarios = as.numeric(as.character(Agropecuarios)))
data <- mutate(data, Energeticos = as.numeric(as.character(Energeticos)))
str(data)
head(data)
data <- read.csv("indicadores.csv", fileEncoding="UTF-8-BOM")
str(data)                                                                                    ###################
data <- select(data, General:Energeticos)                                                    ## Hacer una vez ##
data <- mutate(data, Periodo= seq(ymd("1970-1-1"), ymd("2020-12-1"), by = "months"))         ###################
write.csv(data, "Indice-nacional-de-precios-al-consumidor.csv", row.names = FALSE)
data <- read.csv("indicadores.csv", fileEncoding="UTF-8-BOM")
str(data)                                                                                    ###################
data <- select(data, General:Energeticos)                                                    ## Hacer una vez ##
data <- mutate(data, Periodo= seq(ymd("1970-1-1"), ymd("2020-12-1"), by = "months"))         ###################
write.csv(data, "Indice-nacional-de-precios-al-consumidor.csv", row.names = FALSE)
data <- read.csv("Indice-nacional-de-precios-al-consumidor.csv", fileEncoding="UTF-8-BOM")
data <- mutate(data, Periodo = as.Date(Periodo, "%Y-%m-%d"))
data <- mutate(data, General = as.numeric(as.character(General)))
data <- mutate(data, Subyacente = as.numeric(as.character(Subyacente)))
data <- mutate(data, Mercancias = as.numeric(as.character(Mercancias)))
data <- mutate(data, Servicios = as.numeric(as.character(Servicios)))
data <- mutate(data, Nosubyacente = as.numeric(as.character(Nosubyacente)))
data <- mutate(data, Agropecuarios = as.numeric(as.character(Agropecuarios)))
data <- mutate(data, Energeticos = as.numeric(as.character(Energeticos)))
str(data)
head(data)
tail(data)
indices.2005 <-  data %>% filter(Periodo >= ymd("2005-1-1"))
str(indices.2005)
head(indices.2005)
tail(indices.2005)
indices.2005.maxgeneral <- which.max(indices.2005$General)
paste("En la fecha", indices.2005$Periodo[indices.2005.maxgeneral]," se presento la mayor inflacion registrada de 2005 a 2020 con" , indices.2005$General[indices.2005.maxgeneral], "%")
indices.2005.maxgeneral <- which.max(indices.2005$General)
paste("En la fecha", indices.2005$Periodo[indices.2005.maxgeneral]," se presento la mayor inflación registrada de 2005 a 2020 con un" , indices.2005$General[indices.2005.maxgeneral], "%")
indices.2005.mingeneral <- which.min(indices.2005$General)
paste("En la fecha", indices.2005$Periodo[indices.2005.mingeneral]," se presento la menor inflación registrada de 2005 a 2020 con un" , indices.2005$General[indices.2005.mingeneral], "%")
indices.2005.general <- data.frame(x = indices.2005$Periodo, y = indices.2005$General, group = rep("General", nrow(indices.2005)))
indices.2005.subyacente <- data.frame(x = indices.2005$Periodo, y = indices.2005$Subyacente, group = rep("Subyacente", nrow(indices.2005)))
indices.2005.mercancias <- data.frame(x = indices.2005$Periodo, y = indices.2005$Mercancias, group = rep("Mercancias", nrow(indices.2005)))
indices.2005.servicios <- data.frame(x = indices.2005$Periodo, y = indices.2005$Servicios, group = rep("Servicios", nrow(indices.2005)))
indices.2005.nosubyacente <- data.frame(x = indices.2005$Periodo, y = indices.2005$Nosubyacente, group = rep("Nosubyacente", nrow(indices.2005)))
indices.2005.agropecuarios <- data.frame(x = indices.2005$Periodo, y = indices.2005$Agropecuarios, group = rep("Agropecuarios", nrow(indices.2005)))
indices.2005.energeticos <- data.frame(x = indices.2005$Periodo, y = indices.2005$Energeticos, group = rep("Energeticos", nrow(indices.2005)))
indices.2005.lista <- list(indices.2005.general,
indices.2005.subyacente,
indices.2005.mercancias,
indices.2005.servicios,
indices.2005.nosubyacente,
indices.2005.agropecuarios,
indices.2005.energeticos)
indices.2005.groupdata <- do.call(rbind,indices.2005.lista)
indices.2005.groupdata
indices.2005.maxgroup <- which.max(indices.2005.groupdata$y)
paste("En la fecha", indices.2005.groupdata$x[indices.2005.maxgroup], "la categoría de",
indices.2005.groupdata$group[indices.2005.maxgroup],
"se presento la mayor inflacion registrada de 2005 a 2020 con" , indices.2005.groupdata$y[indices.2005.maxgroup], "%")
indices.2005.maxgroup <- which.max(indices.2005.groupdata$y)
paste("En la fecha", indices.2005.groupdata$x[indices.2005.maxgroup], "la categoría de",
indices.2005.groupdata$group[indices.2005.maxgroup],
"se presento la mayor inflación registrada de 2005 a 2020 con el" , indices.2005.groupdata$y[indices.2005.maxgroup], "%")
indices.2005.mingroup <- which.min(indices.2005.groupdata$y)
paste("En la fecha", indices.2005.groupdata$x[indices.2005.mingroup], "la categoría de",
indices.2005.groupdata$group[indices.2005.mingroup],
"se presento la mayor inflación registrada de 2005 a 2020 con el" , indices.2005.groupdata$y[indices.2005.mingroup], "%")
indices.2005.mingroup <- which.min(indices.2005.groupdata$y)
paste("En la fecha", indices.2005.groupdata$x[indices.2005.mingroup], "la categoría de",
indices.2005.groupdata$group[indices.2005.mingroup],
"se presento la menor inflación registrada de 2005 a 2020 con el" , indices.2005.groupdata$y[indices.2005.mingroup], "%")
indices.2005.general.plot <- ggplot(indices.2005.general, aes(x, y, col = group)) + geom_line()
indices.2005.general.plot
indices.2005.subgeneral.plot <- ggplot( rbind(indices.2005.general,
indices.2005.subyacente,
indices.2005.nosubyacente),
aes(x, y, col = group)) + geom_line()
indices.2005.subgeneral.plot
indices.2005.total.plot <- ggplot(rbind(indices.2005.general,
indices.2005.mercancias,
indices.2005.servicios),
aes(x, y, col = group)) + geom_line()
indices.2005.general.plot <- ggplot(indices.2005.general, aes(x, y, col = group)) + geom_line()
indices.2005.general.plot
indices.2005.subgeneral.plot <- ggplot( rbind(indices.2005.general,
indices.2005.subyacente,
indices.2005.nosubyacente),
xlab = "Tiempo",
aes(x, y, col = group)) + geom_line()
indices.2005.subgeneral.plot
indices.2005.general.plot <- ggplot(indices.2005.general, aes(x, y, col = group)) + geom_line()
indices.2005.general.plot
indices.2005.subgeneral.plot <- ggplot( rbind(indices.2005.general,
indices.2005.subyacente,
indices.2005.nosubyacente),
aes(x, y, col = group)) + geom_line()
indices.2005.subgeneral.plot
ts.plot(cbind(Trend, Trend*Seasonal), , main = "Datos de Producción de Electricidad",
ylab = "Producción de electricidad", lty = 1:2,
sub = "Tendencia con efectos estacionales multiplicativos sobrepuestos")
indices.2005.total.plot <- ggplot(rbind(indices.2005.general,
indices.2005.mercancias,
indices.2005.servicios),
aes(x, y, col = group)) + geom_line()
indices.2005.total.plot
indices.2005.total.plot <- ggplot(rbind(indices.2005.general,
indices.2005.agropecuarios,
indices.2005.energeticos),
aes(x, y, col = group)) + geom_line()
indices.2005.total.plot
ggplot(indices.2005.groupdata, aes(x = group, y = y, fill = group)) + geom_boxplot() +
ggtitle("Boxplots") +
xlab("Categorias") +
ylab("Mediciones")
ggplot(indices.2005.groupdata, aes(x = group, y = y, fill = group)) + geom_boxplot() +
ggtitle("Boxplots de tipo de inflaciones") +
xlab("Categorías") +
ylab("Inflación")
modelo.general <- lm(indices.2005$General ~ indices.2005$Subyacente + indices.2005$Nosubyacente)
summary(modelo.general)
modelo.componentes <- lm(indices.2005$General ~ indices.2005$Mercancias + indices.2005$Servicios + indices.2005$Agropecuarios + indices.2005$Energeticos)
summary(modelo.componentes)
indices.2005.general.ts <- ts(indices.2005$General, start = 2005, freq = 12)
plot(indices.2005.general.ts,
main = "Inflacion en Mexico",
xlab = "Tiempo",
ylab = "Inflacion",
sub = "Enero de 2005 - Diciembre de 2020")
indices.2005.general.ts <- ts(indices.2005$General, start = 2005, freq = 12)
plot(indices.2005.general.ts,
main = "Inflación en México",
xlab = "Tiempo",
ylab = "Inflación",
sub = "Enero de 2005 - Diciembre de 2020")
indices.2005.general.ts.aditivo <- decompose(indices.2005.general.ts)
plot(indices.2005.general.ts.aditivo, xlab = "Tiempo",
sub = "Descomposición de los datos de inflacion")
Tendencia <- indices.2005.general.ts.aditivo$trend
Estacionalidad <- indices.2005.general.ts.aditivo$seasonal
Aleatorio <- indices.2005.general.ts.aditivo$random
ts.plot(cbind(Tendencia, Tendencia + Estacionalidad),
xlab = "Tiempo", main = "Datos de Producción de Electricidad",
ylab = "Producción de electricidad", lty = 1:2,
sub = "Tendencia con efectos estacionales aditivos sobrepuestos")
indices.2005.general.ts.multiplicativo <- decompose(indices.2005.general.ts, type = "mult")
plot(indices.2005.general.ts.multiplicativo, xlab = "Tiempo",
sub = "Descomposición de los datos de producción de electricidad")
Trend <- indices.2005.general.ts.multiplicativo$trend
Seasonal <- indices.2005.general.ts.multiplicativo$seasonal
Random <- indices.2005.general.ts.multiplicativo$random
ts.plot(cbind(Trend, Trend*Seasonal), xlab = "Tiempo", main = "Datos de Producción de Electricidad",
ylab = "Producción de electricidad", lty = 1:2,
sub = "Tendencia con efectos estacionales multiplicativos sobrepuestos")
indices.2005.general.ts.aditivo <- decompose(indices.2005.general.ts)
plot(indices.2005.general.ts.aditivo, xlab = "Tiempo",
sub = "Descomposición de los datos de inflacion")
Tendencia <- indices.2005.general.ts.aditivo$trend
Estacionalidad <- indices.2005.general.ts.aditivo$seasonal
Aleatorio <- indices.2005.general.ts.aditivo$random
ts.plot(cbind(Tendencia, Tendencia + Estacionalidad),
xlab = "Tiempo", main = "Datos de Producción de Electricidad",
ylab = "Producción de electricidad", lty = 1:2,
sub = "Tendencia con efectos estacionales aditivos sobrepuestos")
